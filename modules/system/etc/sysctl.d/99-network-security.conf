# Configuración de seguridad de red
# Protecciones genéricas contra ataques comunes

# Protección contra SYN flood
net.ipv4.tcp_syncookies = 1

# Deshabilitar reenvío de paquetes (no es un router)
net.ipv4.ip_forward = 0
net.ipv6.conf.all.forwarding = 0

# No aceptar redirecciones ICMP (pueden usarse en ataques de redireccionamiento)
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0

# No aceptar rutas de origen (source routes)
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.default.accept_source_route = 0
net.ipv6.conf.all.accept_source_route = 0
net.ipv6.conf.default.accept_source_route = 0

# Registrar paquetes anómalos/maliciosos
net.ipv4.conf.all.log_martians = 1
net.ipv4.conf.default.log_martians = 1

# Ignorar solicitudes ICMP echo (ping) opcionales pero mejora privacidad
# net.ipv4.icmp_echo_ignore_all = 1

# TCP hardening: aumentar timeouts de conexión en espera
net.ipv4.tcp_fin_timeout = 30
net.ipv4.tcp_keepalive_time = 600
